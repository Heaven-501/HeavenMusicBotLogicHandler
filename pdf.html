<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
  <title>Heaven Community App</title>

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/pdf.js/3.4.120/pdf.min.js"></script>

  <style>
    /* --- GLOBAL RESET --- */
    *, *::before, *::after { box-sizing: border-box; }

    body {
      margin: 0; padding: 0; padding-bottom: 90px;
      font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif;
      background: #0f172a; color: #e5e7eb;
      -webkit-text-size-adjust: 100%; -webkit-font-smoothing: antialiased;
    }

    .container { max-width: 560px; margin: 0 auto; padding: 24px 20px; width: 100%; }

    /* --- TAB SYSTEM --- */
    .tab-content { display: none; animation: fadeIn 0.3s ease; }
    .tab-content.active { display: block; }
    @keyframes fadeIn { from { opacity: 0; transform: translateY(5px); } to { opacity: 1; transform: translateY(0); } }

    /* --- UI ELEMENTS --- */
    .section-title { font-size: 15px; font-weight: 600; color: #38bdf8; margin: 8px 0 16px; text-transform: uppercase; letter-spacing: 0.04em; }

    .converter-card {
      background: #1e293b; border: 1px solid #334155; border-radius: 20px;
      padding: 20px; margin-bottom: 20px; box-shadow: 0 10px 25px rgba(0,0,0,0.2);
    }

    .tool-header { display: flex; align-items: center; gap: 12px; margin-bottom: 15px; }
    .tool-header span { font-size: 24px; }
    .tool-header h3 { margin: 0; font-size: 18px; color: #f8fafc; }

    textarea {
      width: 100%; height: 160px; background: #0f172a; border: 1px solid #334155;
      border-radius: 12px; padding: 12px; color: #e5e7eb; font-family: inherit;
      resize: none; margin-bottom: 12px; outline: none; line-height: 1.5;
    }
    textarea:focus { border-color: #38bdf8; }

    .custom-file-upload {
      display: block; background: #0f172a; border: 2px dashed #334155;
      padding: 20px; text-align: center; border-radius: 12px; cursor: pointer;
      color: #94a3b8; transition: all 0.2s; margin-bottom: 12px;
    }
    .custom-file-upload:hover { border-color: #38bdf8; color: #38bdf8; }
    input[type="file"] { display: none; }

    .action-btn {
      width: 100%; background: #38bdf8; color: #0f172a; border: none;
      padding: 14px; border-radius: 12px; font-weight: 700; cursor: pointer;
      font-size: 15px; transition: all 0.2s; margin-bottom: 8px;
    }
    .action-btn:active { transform: scale(0.98); opacity: 0.9; }
    .action-btn.secondary { background: #334155; color: #f8fafc; }

    .result-area {
      margin-top: 15px; background: #020617; padding: 15px;
      border-radius: 12px; font-size: 13px; white-space: pre-wrap;
      display: none; border: 1px solid #1e293b; max-height: 300px; overflow-y: auto;
    }

    /* --- BOTTOM NAVIGATION --- */
    .bottom-nav {
      position: fixed; bottom: 0; left: 0; width: 100%; height: 80px;
      background: rgba(15, 23, 42, 0.9); backdrop-filter: blur(12px);
      border-top: 1px solid #1e293b; display: flex;
      justify-content: space-around; align-items: center; padding-bottom: 20px; z-index: 100;
    }
    .nav-item {
      display: flex; flex-direction: column; align-items: center; gap: 4px;
      color: #64748b; text-decoration: none; font-size: 11px; font-weight: 500;
      width: 60px; cursor: pointer; -webkit-tap-highlight-color: transparent;
    }
    .nav-item.active { color: #38bdf8; }
    .nav-icon { width: 24px; height: 24px; fill: currentColor; }
  </style>
</head>
<body>

  <div id="tab-home" class="tab-content active">
    <div class="container">
      <div style="text-align: center; margin-bottom: 30px;">
        <h2 class="community-title">Heaven (Â§©ÂõΩ) üåÄ</h2>
        <p style="color:#94a3b8">Premium Community Tools</p>
      </div>
      <p style="text-align:center; font-size: 14px; color:#64748b;">Welcome to the updated Heaven Toolset. Use the Tools tab to convert long documents without page cut-offs.</p>
    </div>
  </div>

  <div id="tab-tools" class="tab-content">
    <div class="container">
      <div class="section-title">Heaven Utilities</div>

      <div class="converter-card">
        <div class="tool-header">
          <span>üìÑ</span>
          <h3>Text to PDF</h3>
        </div>
        <textarea id="pdfText" placeholder="Paste long text here. Heaven will automatically create as many pages as needed..."></textarea>
        <button class="action-btn" onclick="convertToPdf()">Generate Multi-Page PDF</button>
      </div>

      <div class="converter-card">
        <div class="tool-header">
          <span>üìù</span>
          <h3>PDF to Text</h3>
        </div>
        <label for="fileInput" class="custom-file-upload" id="fileLabel">
          Tap to upload PDF
        </label>
        <input type="file" id="fileInput" accept="application/pdf" onchange="handleFileSelect(this)">
        <button class="action-btn" onclick="extractText()">Extract All Pages</button>
        <div id="textResult" class="result-area"></div>
        <button id="copyBtn" class="action-btn secondary" style="display:none; margin-top:10px;" onclick="copyResult()">Copy Extracted Text</button>
      </div>
    </div>
  </div>

  <nav class="bottom-nav">
    <div class="nav-item active" onclick="switchTab('tab-home', this)">
      <svg class="nav-icon" viewBox="0 0 24 24"><path d="M12 5.69l5 4.5V18h-2v-6H9v6H7v-7.81l5-4.5M12 3L2 12h3v8h6v-6h2v6h6v-8h3L12 3z"/></svg>
      <span>Home</span>
    </div>
    <div class="nav-item" onclick="switchTab('tab-tools', this)">
      <svg class="nav-icon" viewBox="0 0 24 24"><path d="M22.7 19l-9.1-9.1c.9-2.3.4-5-1.5-6.9-2-2-5-2.4-7.4-1.3L9 6 6 9 1.6 4.7C.4 7.1.9 10.1 2.9 12.1c1.9 1.9 4.6 2.4 6.9 1.5l9.1 9.1c.4.4 1 .4 1.4 0l2.3-2.3c.5-.4.5-1.1.1-1.4z"/></svg>
      <span>Tools</span>
    </div>
  </nav>

  <script>
    pdfjsLib.GlobalWorkerOptions.workerSrc = 'https://cdnjs.cloudflare.com/ajax/libs/pdf.js/3.4.120/pdf.worker.min.js';

    function switchTab(tabId, navElement) {
      document.querySelectorAll('.tab-content').forEach(el => el.classList.remove('active'));
      document.querySelectorAll('.nav-item').forEach(el => el.classList.remove('active'));
      document.getElementById(tabId).classList.add('active');
      navElement.classList.add('active');
    }

    // --- UPDATED: MULTI-PAGE TEXT TO PDF ---
    function convertToPdf() {
      const { jsPDF } = window.jspdf;
      const doc = new jsPDF();
      const text = document.getElementById('pdfText').value;

      if (!text.trim()) {
        alert("Enter some text first!");
        return;
      }

      // PDF Configuration
      const margin = 15;
      const pageHeight = doc.internal.pageSize.height;
      const maxWidth = doc.internal.pageSize.width - (margin * 2);
      
      // Split text into lines that fit the width
      const lines = doc.splitTextToSize(text, maxWidth);
      
      let cursorY = margin;
      
      lines.forEach(line => {
        // If the next line would exceed the page height, add a new page
        if (cursorY + 10 > pageHeight - margin) {
          doc.addPage();
          cursorY = margin; // Reset cursor to top of new page
        }
        doc.text(line, margin, cursorY);
        cursorY += 7; // Line spacing
      });

      doc.save("Heaven_MultiPage_Doc.pdf");
    }

    // --- PDF TO TEXT LOGIC ---
    function handleFileSelect(input) {
      const fileName = input.files[0] ? input.files[0].name : "Tap to upload PDF";
      document.getElementById('fileLabel').innerText = fileName;
    }

    async function extractText() {
      const fileInput = document.getElementById('fileInput');
      const resultArea = document.getElementById('textResult');
      const copyBtn = document.getElementById('copyBtn');
      
      if (!fileInput.files[0]) {
        alert("Upload a PDF!");
        return;
      }

      resultArea.style.display = 'block';
      resultArea.innerText = "üåÄ Heaven is reading all pages... Please wait.";
      copyBtn.style.display = 'none';

      const file = fileInput.files[0];
      const reader = new FileReader();

      reader.onload = async function() {
        try {
          const typedarray = new Uint8Array(this.result);
          const pdf = await pdfjsLib.getDocument(typedarray).promise;
          let extractedText = "";

          for (let i = 1; i <= pdf.numPages; i++) {
            const page = await pdf.getPage(i);
            const
              
